<Window x:Class="WechatClear.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WechatClear"
        mc:Ignorable="d"
        xmlns:viewModels="clr-namespace:WechatClear.ViewModels"
        Title="MainWindow" Height="550" Width="900">
    <DockPanel>
        <Grid Margin="8 0 4 4" DockPanel.Dock="Top" Height="30">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="100"/>
            </Grid.ColumnDefinitions>

            <TextBox x:Name="txtFolderPath" 
                 Grid.Column="0" 
                 Margin="0,0,10,0" 
                 VerticalAlignment="Center"
                 IsReadOnly="True" />
            
            <Button x:Name="btnSelectFolder"
                Grid.Column="1"
                Content="选择文件夹"
                VerticalAlignment="Center"
                Click="btnSelectFolder_Click"/>
        </Grid>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="282"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="1*"/>
            </Grid.ColumnDefinitions>
            <GroupBox Header="WeChat 列表" Grid.Column="0">
                <TreeView ItemsSource="{Binding Elements}">
                    <TreeView.ItemContainerStyle>
                        <Style TargetType="{x:Type TreeViewItem}">
                            <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
                            <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}" />
                            <Setter Property="FontWeight" Value="Normal" />
                            <EventSetter Event="Selected" Handler="TreeViewItem_Selected" />
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="FontWeight" Value="Bold" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TreeView.ItemContainerStyle>
                    <TreeView.ItemTemplate>
                        <HierarchicalDataTemplate ItemsSource="{Binding Children}" DataType="viewModels:ElementViewModel">
                            <StackPanel Orientation="Horizontal">
                                <Image Width="16" Height="16" Margin="0,0,5,0">
                                    <Image.Style>
                                        <Style TargetType="{x:Type Image}">
                                            <Setter Property="Source" Value="Resources/Pane.png" />
                                        </Style>
                                    </Image.Style>
                                </Image>
                                <TextBlock Text="{Binding Dir}" />
                            </StackPanel>
                        </HierarchicalDataTemplate>
                    </TreeView.ItemTemplate>
                </TreeView>
            </GroupBox>
            <GridSplitter Grid.Column="1" HorizontalAlignment="Stretch" />
            <ScrollViewer VerticalScrollBarVisibility="Auto" Grid.Column="2">
                <GroupBox Header="Details">
                    <ItemsControl ItemsSource="{Binding SelectedItemDetails}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate DataType="viewModels:DetailGroupViewModel">
                                <Expander Header="{Binding Name}" IsExpanded="True">
                                    <ItemsControl ItemsSource="{Binding Details}" Grid.IsSharedSizeScope="True">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" SharedSizeGroup="DetailColumnKey" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <TextBox Grid.Column="0" IsReadOnly="True" Text="{Binding Key}">
                                                        <TextBox.Style>
                                                            <Style BasedOn="{StaticResource SelectableLabel}" TargetType="{x:Type TextBox}">
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Important}" Value="True">
                                                                        <Setter Property="FontWeight" Value="Bold"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBox.Style>
                                                    </TextBox>
                                                    <TextBox Grid.Column="1" IsReadOnly="True" Text="{Binding Value}" Margin="5,0,0,0">
                                                        <TextBox.Style>
                                                            <Style BasedOn="{StaticResource SelectableLabel}" TargetType="{x:Type TextBox}">
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Value}" Value="No">
                                                                        <Setter Property="TextBox.Foreground" Value="Red" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Value}" Value="Yes">
                                                                        <Setter Property="TextBox.Foreground" Value="Green" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBox.Style>
                                                    </TextBox>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </Expander>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </GroupBox>
            </ScrollViewer>
        </Grid>
    </DockPanel>
</Window>
